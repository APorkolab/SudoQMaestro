<app-error-boundary 
  title="Puzzle Loading Error"
  message="Failed to load the Sudoku puzzle. Please try generating a new one."
>
  <div class="controls">
    <button 
      (click)="loadNewPuzzle('easy')"
      [disabled]="isLoading()"
    >
      @if (isLoading()) {
        Loading...
      } @else {
        New Easy Game
      }
    </button>
    <button 
      (click)="loadNewPuzzle('medium')"
      [disabled]="isLoading()"
    >
      @if (isLoading()) {
        Loading...
      } @else {
        New Medium Game
      }
    </button>
    <button 
      (click)="loadNewPuzzle('hard')"
      [disabled]="isLoading()"
    >
      @if (isLoading()) {
        Loading...
      } @else {
        New Hard Game
      }
    </button>
  </div>

  @if (error()) {
    <div class="error-message" role="alert">
      <span class="error-icon">⚠️</span>
      <span>{{ error() }}</span>
      <button 
        class="error-retry" 
        (click)="loadNewPuzzle()"
        [disabled]="isLoading()"
      >
        Retry
      </button>
    </div>
  }

  <app-image-uploader 
    (solveSuccess)="onPuzzleSolvedFromImage($event)"
    (uploadError)="onImageSolveError($event)"
  ></app-image-uploader>

  <div class="grid-container">
    @if (isLoading() && !puzzleState()) {
      <div class="loading-state">
        <div class="loading-spinner"></div>
        <p>Generating puzzle...</p>
      </div>
    } @else if (puzzleState()?.puzzle) {
      <app-sudoku-grid 
        [grid]="puzzleState()!.puzzle" 
        [readonly]="true"
      ></app-sudoku-grid>
    } @else if (!error()) {
      <div class="empty-state">
        <p>No puzzle loaded. Click a button above to generate a new puzzle!</p>
      </div>
    }
  </div>
</app-error-boundary>

<footer>
  <p>Built with Angular & Express</p>
</footer>
